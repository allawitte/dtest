!function(){"use strict";function e(e,t,n,o,r,a){e.header=!1,o(function(){e.currentUser=t.get("userId")||{};var o=$.inArray(n.current.url,["/login","/register"])===-1,r="string"==typeof e.currentUser;o&&!r&&n.go("/login")})}angular.module("app",["ngAnimate","ui.router","ngCookies","transl","ngIntlTelInput","api.config","jmApp","ui.bootstrap","ngTouch","ui.select","imageupload","ngTable","angularUtils.directives.dirPagination","sbDateSelect","ngOnlyNumberApp","LocalStorageModule","ngRoute","daterangepicker"]).run(e),e.$inject=["$rootScope","$cookieStore","$state","$timeout","$location","Functions"]}(),angular.module("api.config",[]).constant("API_ENDPOINT","http://api.hello-detox.com:80/api"),function(){"use strict";function e(e){e.useStaticFilesLoader({prefix:"app/l10n/",suffix:".json"}),e.preferredLanguage("ru"),e.useSanitizeValueStrategy("escape")}angular.module("transl",["pascalprecht.translate"]).config(e),e.$inject=["$translateProvider"]}(),function(){"use strict";function e(e,t,n,o){n.defaults.withCredentials=!0;var r="app/";o.html5Mode({enabled:!0}),t.otherwise("/admin"),e.state("/home",{url:"","abstract":!0,controller:"HomeController",templateUrl:r+"pages/home/home.view.html",controllerAs:"vm",id:"home"}).state("/home.admin",{url:"/admin",templateUrl:r+"pages/admin/admin.html",controller:"DashboardController",controllerAs:"vm"}).state("/actions",{url:"",controller:"HomeController",templateUrl:r+"pages/home/home.view.html",controllerAs:"vm",id:"actions"}).state("/actions.add",{url:"/actions/add",templateUrl:r+"pages/actions/add-action.html",controller:"AddActionController",controllerAs:"vm"}).state("/actions.view",{url:"/actions/view:actionID",templateUrl:r+"pages/actions/view-action.html",controller:"ViewActionController",controllerAs:"vm"}).state("/actions.list",{url:"/actions/list",templateUrl:r+"pages/actions/list-action.html",controller:"ListActionController",controllerAs:"vm"}).state("/actions.edit",{url:"/actions/edit/:actionID",templateUrl:r+"pages/actions/edit-action.html",controller:"EditActionController",controllerAs:"vm"}).state("/receipts",{url:"","abstract":!0,controller:"HomeController",templateUrl:r+"pages/home/home.view.html",controllerAs:"vm",id:"actions"}).state("/receipts.add",{url:"/receipts/add",templateUrl:r+"pages/receipts/add-receipt.html",controller:"ReceiptsAddController",controllerAs:"vm"}).state("/receipts.list",{url:"/receipts/list",templateUrl:r+"pages/receipts/list-receipts.html",controller:"ReceiptsListController",controllerAs:"vm"}).state("/receipts.view",{url:"/receipts/view/:receiptID",templateUrl:r+"pages/receipts/view-receipt.html",controller:"ReceiptsViewController",controllerAs:"vm"}).state("/receipts.edit",{url:"/receipts/edit/:receiptID",templateUrl:r+"pages/receipts/edit-receipt.html",controller:"ReceiptsEditController",controllerAs:"vm"}).state("/programs",{url:"","abstract":!0,controller:"HomeController",templateUrl:r+"pages/home/home.view.html",controllerAs:"vm",id:"actions"}).state("/programs.add",{url:"/programs/add/:userId",params:{userId:null},templateUrl:r+"pages/programs/add.program.html",controller:"ProgramController",controllerAs:"vm",id:"program"}).state("/planday",{url:"","abstract":!0,controller:"HomeController",templateUrl:r+"pages/home/home.view.html",controllerAs:"vm",id:"planday"}).state("/planday.add",{url:"/planday/add/:userId",params:{userId:null},templateUrl:r+"pages/planday/add.planday.html",controller:"PlandayController",controllerAs:"vm",id:"plandayAdd"}).state("/members",{url:"","abstract":!0,controller:"HomeController",templateUrl:r+"pages/home/home.view.html",controllerAs:"vm",id:"actions"}).state("/members.list",{url:"/members/list",templateUrl:r+"pages/users/list.members.html",controller:"MembersListController",controllerAs:"vm",id:"members"}).state("/members.view",{url:"/members/view/:userId",params:{userId:null},templateUrl:r+"pages/users/view.member.html",controller:"viewMembersController",controllerAs:"vm",id:"member"}).state("/login",{url:"/login",controller:"LoginController",templateUrl:r+"pages/login/login.view.html",controllerAs:"vm",id:"login"}).state("/register",{url:"/register",controller:"RegisterController",templateUrl:r+"pages/register/register.view.html",controllerAs:"vm",id:"login"}).state("/client",{url:"","abstract":!0,controller:"ClientController",templateUrl:r+"pages/client/client.view.html",controllerAs:"vm",id:"client"}).state("/survey",{url:"/survey",controller:"SurveyController",templateUrl:r+"pages/survey/survey.view.html",controllerAs:"vm",id:"survey"}).state("/client.prep",{url:"/client/prep",controller:"ClientPrepController",templateUrl:r+"pages/client/prep/client.prep.view.html",controllerAs:"vm",id:"office"}).state("/client.office",{url:"/client/office/:userId",params:{userId:null},controller:"ClientOfficeController",templateUrl:r+"pages/client/office/client.office.view.html",controllerAs:"vm"}).state("receipt",{parent:"/client",url:"/receipt",params:{pageType:null},controller:"ClientReceiptController",templateUrl:r+"pages/client/office/pages/receipt.view.html",controllerAs:"vm"}).state("card",{parent:"/client",url:"/card",params:{pageType:null},controller:"ClientCardController",templateUrl:r+"pages/client/office/pages/card.view.html",controllerAs:"vm"}).state("shopping",{parent:"/client",url:"/shopping",params:{pageType:null},controller:"ClientShoppingController",templateUrl:r+"pages/client/office/pages/shopping.view.html",controllerAs:"vm"})}angular.module("app").config(e),e.$inject=["$stateProvider","$urlRouterProvider","$httpProvider","$locationProvider"]}(),function(){"use strict";function e(e,t){function n(){1==e.showSideMenu?(e.showSideMenu=!1,e.sideMenu=""):(e.showSideMenu=!0,e.sideMenu="in")}e.showSideMenu=!0,e.sideMenu="",e.toggleSideMenu=n,e.$on("$stateChangeSuccess",function(t,n,o,r,a){e.page=n}),e.$on("$stateChangeError",function(e,n,o,r,a,i){angular.isString(i)||(i=JSON.stringify(i)),t.error("$stateChangeError: "+i)})}angular.module("app").controller("MainController",e),e.$inject=["$rootScope","$log"]}(),function(){"use strict";function e(e,t,n){function o(o,r){e.put(n+"/login",o).then(function(e){console.log(e.data.data),t.put("userId",e.data.data.userId);var n=e.data.data;n.success=!0,r(n)},function(e,t){console.log(e),e={success:!1,message:"LOGIN.LOGINERR"},r(e)})}var r={};return r.Login=o,r}angular.module("app").factory("AuthenticationService",e),e.$inject=["$http","$cookieStore","API_ENDPOINT"]}(),function(){"use strict";function e(e,t,n){function o(n,o){e["delete"](t+"/cards/"+n).success(function(e,t,n,r){o(e)}).error(function(e,t,n,o){c(t)})}function r(n,o,r){e.put(t+"/cards/"+n,JSON.stringify(o)).success(function(e,t,n,o){r(e)}).error(function(e,t,n,o){c(t)})}function a(n,o){e.get(t+"/cards"+n).success(function(e,t,n,r){o(e)}).error(function(e,t,n,o){c(t)})}function i(n,o){e.post(t+"/cards",JSON.stringify(n)).success(function(e,t,n,r){o(e)}).error(function(e,t,n,o){c(t)})}function s(n,o){e.get(t+"/cards/"+n).success(function(e,t,n,r){o(e)}).error(function(e,t,n,o){c(t)})}function c(e){console.log(e),403==e&&n.go("/login")}var l={};return l.actionUpload=i,l.getActionById=s,l.getAllActions=a,l.updateAction=r,l.deleteAction=o,l}angular.module("app").factory("CardsService",e),e.$inject=["$http","API_ENDPOINT","$state"]}(),function(){"use strict";function e(e){function t(){function t(){var t=e.flash;t&&(t.keepAfterLocationChange?t.keepAfterLocationChange=!1:delete e.flash)}e.$on("$locationChangeStart",function(){t()})}function n(t,n){e.flash={message:t,type:"success",keepAfterLocationChange:n}}function o(t,n){e.flash={message:t,type:"error",keepAfterLocationChange:n}}var r={};return r.Success=n,r.Error=o,t(),r}angular.module("app").factory("FlashService",e),e.$inject=["$rootScope"]}(),function(){"use strict";function e(e,t){function n(n,r){e.post(t+"/opinions/firstOpinion",JSON.stringify(n)).success(function(e,t,n,o){r(e)}).error(function(e,t,n,r){o(t)})}function o(e){403==e&&$state.go("/login")}var r={};return r.createUpdateFirstOpinion=n,r}angular.module("app").factory("OpinionService",e),e.$inject=["$http","API_ENDPOINT"]}(),function(){"use strict";function e(e,t,n){function o(n,o){e["delete"](t+"/plandays/"+n).success(function(e,t,n,r){o(e.data)}).error(function(e,t,n,o){i(t)})}function r(n,o){e.get(t+"/plandays?memberId="+n+"&dayFrom=2016-10-01&dayTo=2018-12-30").success(function(e,t,n,r){o(e.data)}).error(function(e,t,n,o){i(t)})}function a(n,o){e.post(t+"/plandays",JSON.stringify(n)).success(function(e,t,n,r){o(t)}).error(function(e,t,n,r){o(t)})}function i(e){console.log(e),403==e&&n.go("/login")}var s={};return s.uploadProgram=a,s.deleteProgram=o,s.getProgram=r,s}angular.module("app").factory("ProgramsService",e),e.$inject=["$http","API_ENDPOINT","$state"]}(),function(){"use strict";function e(e,t,n){function o(n,o){e["delete"](t+"/recipes/"+n).success(function(e,t,n,r){o(e)}).error(function(e,t,n,o){d(t)})}function r(n,o,r){e.put(t+"/recipes/"+n,JSON.stringify(o)).success(function(e,t,n,o){r(e)}).error(function(e,t,n,o){d(t)})}function a(n){if(void 0!==n)return e.get(t+"/recipes/inventoryAutocomplete?word="+n).then(function(e,t,n,o){return e.data.data})}function i(n){if(void 0!==n)return e.get(t+"/recipes/ingredientAutocomplete?word="+n).then(function(e,t,n,o){return e.data.data})}function s(n,o){e.get(t+"/recipes/"+n).success(function(e,t,n,r){o(e)}).error(function(e,t,n,o){d(t)})}function c(e){return g[e]}function l(n){e.get(t+"/recipes?size=100&from=0").success(function(e,t,o,r){g=e.data.data,n(e)}).error(function(e,t,n,o){d(t)})}function u(n,o){e.post(t+"/recipes",JSON.stringify(n)).success(function(e,t,n,r){o(e)}).error(function(e,t,n,o){d(t)})}function p(n,o){e({method:"POST",url:t+"/utils/uploadImage",headers:{"Content-Type":void 0},transformRequest:function(e){var t=new FormData;return t.append("image",n.file),t}}).success(function(e,t,n,r){o(e)}).error(function(e,t,n,o){d(t)})}function d(e){403==e&&n.go("/login")}var m={},g={};return m.imgUpload=p,m.receiptUpload=u,m.receiptDelete=o,m.getAllReceipts=l,m.getReceiptFromList=c,m.getReceiptById=s,m.receiptUpdate=r,m.getIngrAutoComplete=i,m.getIventoryAutoComplete=a,m}angular.module("app").factory("ReceiptService",e),e.$inject=["$http","API_ENDPOINT","$state"]}(),function(){"use strict";function e(e,t){function n(n){return e.get(t+"/users"+n).then(c,l("Error getting all users"))}function o(){return e.get(t+"/users/me").then(c,l)}function r(n){return e.get(t+"/users/"+n).then(c,l)}function a(n){return e.post(t+"/register/",JSON.stringify(n)).then(c,l)}function i(){return e["delete"](t+"/logout/"+id).then(c,l("Error deleting user"))}function s(e){}function c(e){return e.success=!0,e}function l(e){var t;switch(e.status){case 452:t="USERS.EXISTUSER";break;case 406:t="USERS.NOTACCEPTABLE";break;default:t="USERS.REGISTERERR"}return{success:!1,message:t}}var u={};return u.GetAll=n,u.GetMe=o,u.GetById=r,u.Create=a,u.Logout=i,u.DeleteUser=s,u}angular.module("app").factory("UserService",e),e.$inject=["$http","API_ENDPOINT"]}(),function(){"use strict";function e(e,t,n){function o(n,o){e({method:"POST",url:t+"/utils/uploadImage",headers:{"Content-Type":void 0},transformRequest:function(e){var t=new FormData;return t.append("image",n.file),t}}).success(function(e,t,n,r){o(e)}).error(function(e,t,n,o){r(t)})}function r(e){403==e&&n.go("/login")}var a={};return a.imgUpload=o,a}angular.module("app").factory("UtilsService",e),e.$inject=["$http","API_ENDPOINT","$state"]}(),function(){"use strict";function e(e){return function(t){if(console.log("item",t),t)return moment(e.formatPlanDateForMoment(t)).format("dddd, MMMM DD YYYY")}}angular.module("app").filter("dateFilter",e),e.$inject=["Functions"]}(),function(){"use strict";function e(e,t){function n(e){return e+="",e.substring(0,4)+"-"+e.substring(4,6)+"-"+e.substring(6,8)}function o(e,t,n){var o=!1;if(0==e.length)return!1;var r=e.some(function(e,r){return o=r,e[n].toUpperCase()==t[n].toUpperCase()});return!!r&&o}function r(e){return"dailyCalories"in e&&(e.dailyCalories.length>0&&"value"in e.dailyCalories[0]?e.dailyCalories[0].value:void 0)}function a(e){return{btn:f[0],name:g.getReceiptName(e.name),text:e.shortDescription,cooktime:e.timeCookMinutes,calories:g.getDailyCaloriesForPreview(e),img:e.photo,icon:"img/plate.png"}}function i(e){return"ACTION"==e.cardType?{name:e.textShort,img:e.titlePhoto,text:e.textLong,btn:f[1],icon:"img/fire.png"}:{name:e.textShort,img:e.titlePhoto,text:e.textLong,btn:f[2]}}function s(e){var t=new Date(e),n=0==t.getMinutes()?t.getMinutes()+"0":t.getMinutes();return t.getHours()+":"+n}function c(e,t){return e?"<h2>"+e+"</h2><span>"+t+"</span>":""}function l(e){return e.search("<span>")==-1?"":e.match(/<span>(.*?)<\/span>/i)[1]}function u(e){return e.search("<h2>")==-1?e:e.match(/<h2>(.*?)<\/h2>/i)[1]}function p(){return["COUNT","TABLESPOON","GRAM","TEASPOON","LITER","KG","GLASS","BEAM","PINCH","CLOVE","TASTE"]}function d(){return["EASY","MEDIUM","HARD"]}function m(){return[{type:"CALORIE",value:"",dayPercentageCount:0},{type:"FAT",value:"",dayPercentageCount:0},{type:"CARBOHYDRATE",value:"",dayPercentageCount:0},{type:"PROTEIN",value:"",dayPercentageCount:0}]}var g={},f=["PLANDAY.COOK","PLANDAY.DO","PLANDAY.LOOK"];return g.getUnits=p,g.getLevel=d,g.getDailyCalories=m,g.getReceiptName=u,g.getReceiptSubName=l,g.makeTitle=c,g.getTime=s,g.getCardPreview=i,g.getReceiptPreview=a,g.getDailyCaloriesForPreview=r,g.isObjectInArray=o,g.formatPlanDateForMoment=n,g}angular.module("app").factory("Functions",e),e.$inject=["$http","API_ENDPOINT","$state"]}(),function(){"use strict";function e(e){function t(e){var t,n=h.data.some(function(n,o){return t=o,n.planDate>e});return!!n&&t}function n(e,t){return h.data.slice(h.getMinIndexByDate(e),h.getMinIndexByDate(t)+1)}function o(){return{min:e.formatPlanDateForMoment(f().plan.planDate),max:e.formatPlanDateForMoment(m().plan.planDate)}}function r(t,o){var r=[];return n(t,o).forEach(function(t){t.todo.forEach(function(t){"ingredients"in t.obj&&t.obj.ingredients.forEach(function(t){var n=e.isObjectInArray(r,t,"name");n===!1?r.push({value:t.value,name:t.name,unit:t.unit}):r[n].value+=t.value})})}),r}function a(){for(var e=0;e<h.data.length;e++)if(h.data[e].planDate==h.getToday())return{plan:h.data[e],dayNumber:e}}function i(){var e=h.getLastDay();return e.plan.planDate}function s(){var e=h.getFirstDay();return e.plan.planDate}function c(){return moment().format("YYYYMMDD")}function l(){return h.currentDay}function u(e){h.currentDay=e}function p(){return h.fullPageData}function d(e){h.fullPageData=e}function m(){return{plan:h.data[h.data.length-1],dayNumber:h.data.length-1}}function g(e){return e<h.data.length&&e>-1?{plan:h.data[e],dayNumber:e}:e>=h.data.length?m():e<0?f():void 0}function f(){return{plan:h.data[0],dayNumber:0}}function v(e){h.data=e}var h={};return h.setData=v,h.getFirstDay=f,h.getFirstDate=s,h.getLastDay=m,h.getLastDate=i,h.getDay=g,h.getToday=c,h.getTodayPlan=a,h.setFullPageData=d,h.getFullPageData=p,h.setCurrentDay=u,h.getCurrentDay=l,h.getIngredients=r,h.getAvailableDates=o,h.getIngredientsByPeriod=n,h.getMinIndexByDate=t,h}angular.module("app").factory("PlanDaysData",e),e.$inject=["Functions"]}(),function(){"use strict";function e(e,t,n){function o(){return E}function r(){return T}function a(e){E=e}function i(e){T=e}function s(e,t){R[e]=t}function c(e,t){I[e]=t}function l(){S=[]}function u(){return S}function p(e){S=e}function d(e){I=e}function m(e){R=e}function g(){return t.all({receipts:e.get(n+"/recipes?size=100&from=0"),cards:e.get(n+"/cards?size=100&from=0")})}function f(e,t){return new Date(e.getFullYear(),e.getMonth(),e.getDate(),t.getHours(),t.getMinutes())}function v(e){var t=new Date(Date.parse(e)),n=t.getFullYear(),o=t.getMonth()<10?"0"+(t.getMonth()+1):t.getMonth()+1,r=t.getDate()<10?"0"+t.getDate():t.getDate();return n+"-"+o+"-"+r}function h(){}function y(){var e=Object.assign(R,I),t=[];for(var n in e)"cardType"in e[n]?t.push({id:n,name:e[n].textShort,type:e[n].cardType}):"name"in e[n]&&t.push({id:n,name:P(e[n].name),type:"RECEIPT"});return e=null,t}function A(e){function t(e,t){return"object"==typeof e&&(!(t in e)||2)}var n={};return n.planBuckets=[],e.plan.forEach(function(e,o){n.planBuckets.push({bucketTimestamp:Date.parse(e.time)}),e.actions.forEach(function(e){if("RECEIPT"==e.type){t(n.planBuckets[o],"recipes")&&(n.planBuckets[o].recipes=[]);var r=e.id;n.planBuckets[o].recipes.push(R[r])}else"ACTION"!=e.type&&"RECOMMENDATION"!=e.type||(t(n.planBuckets[o],"cards")&&(n.planBuckets[o].cards=[]),n.planBuckets[o].cards.push(I[e.id]))})}),n.planBuckets}function C(){var e=Object.assign(R,I),t=[];for(var n in e)"cardType"in e[n]?t[n]={id:n,name:e[n].textShort,type:e[n].cardType}:"name"in e[n]&&(t[n]={id:n,name:P(e[n].name),type:"RECEIPT"});return e=null,t}function P(e){return e.indexOf("<h2>")>-1?e.match(/<h2>(.*?)<\/h2>/i)[1]:e}var D={};D.modyfyFromServer=h,D.modifyToServer=A,D.modifyCardsDataForLine=y,D.modifyCardsDataForPopUp=C,D.formatPlanDay=v,D.changeDateAndKeepTime=f,D.getAllReceiptsAndCards=g,D.setReceipts=m,D.setActions=d,D.setPlan=p,D.getPlan=u,D.deletePlan=l,D.updateAction=c,D.updateReceipts=s,D.setCards=i,D.getCards=r,D.setCardsIndex=a,D.getCardsIndex=o;var R={},I={},S=[],T=null,E=null;return D}angular.module("app").factory("PlanDayTransfer",e),e.$inject=["$http","$q","API_ENDPOINT"]}(),function(){"use strict";function e(e,t,n,o,r){function a(){g.videos.push({})}function i(e){g.videos.splice(e,1)}function s(e,t){"type"==t&&(console.log(t),g.selectedType=[!1,!1],g.selectedType[e]=!0,g.noType=!1),"media"==t&&(g.selectedMedia=[!1,!1],g.selectedMedia[e]=!0),"video"==t&&(g.selectedSource=[!1,!1],g.selectedSource[e]=!0)}function c(e){return r.trustAsResourceUrl(e)}function l(e){g.photosOk[e]=!1}function u(){g.photos.push({})}function p(t,n){e.imgUpload(t,function(e){e.data&&(void 0!=n?(g.Actions.photos[n]=e.data,g.photosOk[n]=!0):(g.Actions.titlePhoto=e.data,g.imgLoaded=!0))})}function d(e){void 0!=e?g.photos.splice(e,1):(g.Actions.titlePhoto="",g.imgLoaded=!1)}function m(){for(var e=0;e<g.videos.length;e++)if("value"in g.videos[e]){var o=g.videos[e].value,r=o.match(/https([\s\S]*?)\"/);g.Actions.videos.push(r[0].replace('"',""))}g.Actions.cardType?g.noType=!1:g.noType=!0,g.Actions.textShort?g.noName=!1:g.noName=!0,console.log(),g.noName||g.notype||t.actionUpload(g.Actions,function(e){n.go("/actions.list")})}var g=this;g.addImg=u,g.saveImg=p,g.send=m,g.removeImg=d,g.changeImg=l,g.trustSrc=c,g.changeBtn=s,g.addVideo=a,g.deleteVideo=i,g.Actions={photos:[],videos:[]},g.videos=[],g.photos=[],g.photosOk=[],g.chooseMedia=[{title:"ACTIONS.CHOOSEPICTURES",value:"picture"},{title:"ACTIONS.CHOOSEVIDEOS",value:"video"}],g.videosource=[{title:"ACTIONS.YOUTUBESOURCE",value:"youtube"},{title:"ACTIONS.LOCALSOURCE",value:"local"}],g.cardType=[{value:"ACTION",title:"ACTIONS.ACTION"},{value:"RECOMMENDATION",title:"ACTIONS.RECOMMENDATION"}],g.selectedMedia=[!1,!1],g.selectedSource=[!1,!1],g.selectedType=[!1,!1],g.mediaType=!1,g.sourceVideo=!1,g.noName=!1,g.noType=!1}angular.module("app").controller("AddActionController",e),e.$inject=["UtilsService","CardsService","$state","$scope","$sce"]}(),function(){"use strict";function e(e,t,n,o,r,a){function i(e,t){"type"==t&&(console.log(t),A.selectedType=[!1,!1],A.selectedType[e]=!0)}function s(e){A.Actions.videos.splice(e,1)}function c(){A.videos.push({})}function l(e){A.videos.splice(e,1)}function u(){t.deleteAction(C,function(e){console.log(e),n.go("/actions.list")})}function p(e){return r.trustAsResourceUrl(e)}function d(){A.photos.push({});var e=A.photos.length;A.savedPhotos[e-1]=!1,A.fileUplView[e-1]=!0}function m(e){A.Actions.photos.splice(e,1)}function g(e){void 0!=e?(A.savedPhotos.splice(e,1),A.photos.splice(e,1)):(A.Actions.titlePhoto="",A.imgLoaded=!1)}function f(t,n){e.imgUpload(t,function(e){void 0!=n?(A.savedPhotos[n]=e.data,A.fileUplView[n]=!1):(A.Actions.titlePhoto=e.data,A.imgLoaded=!0)})}function v(){A.Actions.titlePhoto="",A.isTitlePhoto=!1}function h(){for(var e=0;e<A.savedPhotos.length;e++)A.Actions.photos.push(A.savedPhotos[e]);for(var e=0;e<A.videos.length;e++)if("value"in A.videos[e]){var o=A.videos[e].value,r=o.match(/https([\s\S]*?)\"/);A.Actions.videos.push(r[0].replace('"',""))}A.Actions.textShort?P?(a.updateAction(C,A.Actions),n.go(D.path,D.params)):t.updateAction(C,A.Actions,function(e){n.go("/actions.list")}):A.noName=!0}function y(){n.go("/actions.list")}var A=this,C=n.params.actionID;A.Actions={},A.photos=[],A.videos=[],A.savedPhotos=[],A.fileUplView=[],A.selectedType=[],A.isTitlePhoto=!1,A.cardType=[{value:"ACTION",title:"ACTIONS.ACTION"},{value:"RECOMMENDATION",title:"ACTIONS.RECOMMENDATION"}],A.removetitlePhoto=v,A.saveImg=f,A.removeImg=g,A.removeRowPhoto=m,A.addImg=d,A.send=h,A.cancel=y,A.deleteAction=u,A.trustSrc=p,A.addVideo=c,A.deleteVideo=l,A.deleteExistVideo=s,A.changeBtn=i,A.noName=!1;var P=!1,D={};o.$on("$stateChangeSuccess",function(e,t,n,o,r){console.log("success",t,n,o,r),o.name.indexOf("planday.add")>=0&&(P=!0,D.path=o.name,D.params=r)}),t.getActionById(C,function(e){A.Actions=e.data,"titlePhoto"in A.Actions&&""!=A.Actions.titlePhoto&&(A.isTitlePhoto=!0),"ACTION"==A.Actions.cardType&&(A.selectedType=[!0,!1]),"RECOMMENDATION"==A.Actions.cardType?A.selectedType=[!1,!0]:A.selectedType=[!1,!1]})}angular.module("app").controller("EditActionController",e),e.$inject=["UtilsService","CardsService","$state","$scope","$sce","PlanDayTransfer"]}(),function(){"use strict";function e(e,t,n,o){function r(n){for(var o=0;o<a.ActionsList.length;o++)a.ActionsList[o].id==n&&a.ActionsList.splice(o,1);t.deleteAction(n,function(e){}),a.tableParams=new e({},{dataset:a.ActionsList})}var a=this;a.ActionsList=[];var i="?size=100&from=0";a.deleteAction=r,t.getAllActions(i,function(t){var n=0;for(var o in t.data.data)a.ActionsList.push(t.data.data[o]),a.ActionsList[n].id=o,n++;a.tableParams=new e({},{dataset:a.ActionsList})})}angular.module("app").controller("ListActionController",e),e.$inject=["NgTableParams","CardsService","$state","$scope"]}(),function(){"use strict";function e(){}angular.module("app").controller("myCtrl",e),e.$inject=["$scope","$http"]}(),function(){"use strict";function e(e,t,n,o){function r(){e.deleteAction(id,function(e){console.log(e),t.go("/actions.list")})}function a(e){return o.trustAsResourceUrl(e)}var i=this;i.Action={},i.deleteAction=r,i.trustSrc=a,i.edit=t.params.actionID,e.getActionById(t.params.actionID,function(e){i.Action=e.data,console.log("response is: ",e)})}angular.module("app").controller("ViewActionController",e),e.$inject=["CardsService","$state","$scope","$sce"]}(),function(){"use strict";function e(e){}angular.module("app").controller("DashboardController",e),e.$inject=["$scope"]}(),function(){"use strict";function e(e,t,n,o,r){var a=t.params.userId;e.isPlanArrLoaded=!1;var i=[];console.log("clientCtrl userId:",a),n.getProgram(a,function(t){for(var n in t.data){t.data[n].key=n;var a=[];t.data[n].planBuckets.forEach(function(e){null!=e&&("cards"in e&&e.cards.forEach(function(t){null!=t&&a.push({time:o.getTime(e.bucketTimestamp),preview:o.getCardPreview(t),obj:t})}),"recipes"in e&&e.recipes.forEach(function(t){null!=t&&a.push({time:o.getTime(e.bucketTimestamp),preview:o.getReceiptPreview(t),obj:t})}))}),i.push({planDate:t.data[n].planDate,memberId:t.data[n].memberId,todo:a})}i.sort(function(e,t){return e.planDate>t.planDate?1:e.planDate<t.planDate?-1:e.planDate==t.planDate?0:void 0}),r.setData(i),e.isPlanArrLoaded=!0})}angular.module("app").controller("ClientController",e),e.$inject=["$scope","$state","ProgramsService","Functions","PlanDaysData"]}(),function(){"use strict";function e(e,t){function n(){t.remove("userId"),e.go("/login")}var o=this;o.logout=n}angular.module("app").controller("HomeController",e),e.$inject=["$state","$cookieStore"]}(),function(){"use strict";function e(e,t,n){function o(){a.dataLoading=!0,t.Login(a.user,function(t){t.success?"ADMIN"==t.user.role?e.go("/home.admin",{eventId:"123"}):(console.log("login:",t.userId),e.go("/client.office",{userId:t.userId})):(n.Error(t.message),a.dataLoading=!1)})}function r(){e.go("/survey")}var a=this;a.login=o,a.register=r,a.user={}}angular.module("app").controller("LoginController",e),e.$inject=["$state","AuthenticationService","FlashService"]}(),function(){"use strict";function e(e,t,n,o,r,a,i,s){function c(){U+=2,S.program.plan.push({time:d(),actions:[]}),N=S.program.plan.length-1,O=0,console.log("vm.program.plan",S.program.plan)}function l(e,t,o){e.stopPropagation(),i.setPlan(S.program),i.setCards(S.cards),i.setCardsIndex(S.cardsIndex),"RECEIPT"==S.program.plan[t].actions[o].type?n.go("/receipts.edit",{receiptID:S.program.plan[t].actions[o].id}):n.go("/actions.edit",{actionID:S.program.plan[t].actions[o].id})}function u(e,t,n){e.stopPropagation(),S.program.plan[t].actions.splice(n,1)}function p(e){S.program.plan.splice(e,1)}function d(){var e=new Date(Date.parse(S.dt));return e.setHours(U),e.setMinutes(0),e}function m(){a(function(){S.program.plan.sort(h)},2e3)}function g(e){return r.trustAsHtml(e)}function f(e,t,n){e.selected=e.name,S.program.plan[t].actions[n]=e}function v(e){S.program.plan[e].actions.push({}),S.modalClose=!1,N=e,O=S.program.plan[e].actions.length-1}function h(e,t){return e.time-t.time}function y(){S.modalClose=!0,C()}function A(e){S.program.plan[N].actions[O]=S.cardsIndex[e],S.modalClose=!0}function C(){S.program.plan.forEach(function(e,t){e.actions.forEach(function(t,n){"{}"==JSON.stringify(t)&&e.actions.splice(n,1)})})}function P(e,t){S.modalClose=!1}function D(){var e=S.PlanDayCreate.memberId;S.PlanDayCreate={},S.PlanDayCreate.memberId=e,S.PlanDayCreate.planBuckets=[]}function R(){S.planErrorArr="",S.planErrorUser="",S.uploadError="",S.alreadyExistsError="",S.allowSave=!0,S.PlanDayCreate.planDay=i.formatPlanDay(S.dt),S.PlanDayCreate.memberId||(S.PlanDayCreate.memberId=S.user.id);var e=S.program.plan.some(function(e){return 0==e.actions.length});e?(S.allowSave=!1,D()):S.PlanDayCreate.planBuckets=i.modifyToServer(S.program),S.allowSave&&S.PlanDayCreate.memberId?t.uploadProgram(S.PlanDayCreate,function(e){D(),console.log(e);var t={200:function(){n.go("/members.view",{userId:S.PlanDayCreate.memberId})},453:function(){S.alreadyExistsError="PROGRAM.ERROR-EXISTS"},455:function(){S.uploadError="PROGRAM.ERROR-UPLOAD"}};t[e]()}):(S.allowSave||(S.planErrorArr="PROGRAM.ERROR-ARRAY"),S.PlanDayCreate.memberId||(S.planErrorUser="PROGRAM.ERROR-USER"),D())}function I(){S.PlanDayCreate.memberId?n.go("/members.view",{userId:S.PlanDayCreate.memberId}):n.go("/members.list")}var S=this;S.addTime=c;var T=new Date,E=T.getFullYear(),w=T.getMonth(),$=T.getDate(),b=7;S.allowSave=!0,S.dt=new Date(E,w,$,b),S.trustSrc=g,S.changed=m,S.onSelectCallback=f,S.addCard=v,S.closeModal=y,S.pendCard=A,S.changeCard=P,S.deleteTimeLine=p,S.send=R,S.cancel=I,S.deleteCard=u,S.program={},S.cards=[],S.cardsIndex=[],S.receipts=[],S.actions=[],S.PlanDayCreate={},S.PlanDayCreate.planBuckets=[],S.PlanDayCreate.memberId=n.params.userId,S.showUsersList=n.params.userId,S.modalClose=!0,S.users=[],S.user={},S.editCard=l;var N=0,O=0,L="?size=100&from=0",U=7;S.program=i.getPlan(),i.deletePlan(),S.cards=i.getCards(),S.cardsIndex=i.getCardsIndex(),o.hstep=1,o.mstep=15,o.ismeridian=!1,o.popup1={opened:!1},o.popup2={opened:!1},o.open1=function(){o.popup1.opened=!0},o.open2=function(){o.popup2.opened=!0};var M=d();"plan"in S.program||(S.program.plan=[],S.program.plan.push({time:M,actions:[]}),i.getAllReceiptsAndCards().then(function(e){S.receipts=e.receipts.data.data.data,S.actions=e.cards.data.data.data,i.setReceipts(S.receipts),i.setActions(S.actions),S.cards=i.modifyCardsDataForLine(),S.cardsIndex=i.modifyCardsDataForPopUp()})),o.$watch(function(){return S.dt},function(e,t){S.program.plan.forEach(function(e){e.time=i.changeDateAndKeepTime(S.dt,e.time)})}),S.program.memberId||e.GetAll(L).then(function(e){var t=0;for(var n in e.data.data.data)S.users.push(e.data.data.data[n]),S.users[t].id=n,t++}),S.showUsersList&&e.GetById(S.showUsersList).then(function(e){S.user=e.data.data.user})}angular.module("app").controller("PlandayController",e),e.$inject=["UserService","ProgramsService","$state","$scope","$sce","$timeout","PlanDayTransfer","$location"]}(),function(){"use strict";function e(e,t,n){function o(t){return e.getIventoryAutoComplete(t)}function r(t){return e.getIngrAutoComplete(t)}function a(){v.Receipt.ingredients.length;v.Receipt.ingredients.push({})}function i(){v.Receipt.inventory.length;v.Receipt.inventory.push("")}function s(e){v.Receipt.ingredients.splice(e,1)}function c(e){v.Receipt.inventory.splice(e,1)}function l(){var n=[],o="",r={},a=0,i="";r.dailyCalories=[],r.ingredients=[];var s=0;for(s=0;s<v.steps.length;s++){for(var c=0;c<v.steps[s].photos.length;c++)v.steps[s].photos[c].img&&n.push(v.steps[s].photos[c].img);v.steps[s].photos=n,n=[]}for(o="<h2>"+v.Receipt.name+"</h2><span>"+v.subname+"</span>",r.name=o||"",r.photo=v.Receipt.photo||"",r.shortDescription=v.Receipt.shortDescription||"",r.timeCookMinutes=v.Receipt.timeCookMinutes||0,r.servesCount=v.Receipt.servesCount||0,r.difficult=v.Receipt.difficult,r.inventory=v.Receipt.inventory||"",r.steps=v.steps,r.dailyCalories=v.Receipt.dailyCalories,s=0;s<v.Receipt.ingredients.length;s++){i=v.Receipt.ingredients[s].name,a=v.Receipt.ingredients[s].value;var l=v.Receipt.ingredients[s].unit;r.ingredients.push({name:i,value:a,unit:l})}v.Receipt.name?e.receiptUpload(r,function(e){t.go("/receipts.list")}):v.noName=!0}function u(){var e=v.steps.length+1;v.steps.push({stepNumber:e,photos:[{id:0}]})}function p(e){v.steps.splice(e,1)}function d(e){var t=v.steps[e].photos.length;v.steps[e].photos.push({id:t})}function m(e,t){void 0!==e?v.steps[e].photos.splice(t,1):v.Receipt.photo=""}function g(t,n,o){e.imgUpload(t,function(e){e.data&&(void 0!=n?v.steps[n].photos[o].img=e.data:(v.Receipt.photo=e.data,v.imgLoaded=!0))})}function f(){t.go("/receipts.list")}var v=this;v.edit=!0,v.view=!1,v.addIngredient=a,v.removeIngredient=s,v.send=l,v.cancel=f,v.addImg=d,v.saveImg=g,v.removeImg=m,v.addStep=u,v.removeStep=p,v.autocompleteIngr=r,v.autocompleteInvent=o,v.addTool=i,v.removeTool=c,v.ingredients=[""],v.inventory=[],v.subname="",v.imgLoaded=!1,v.noName=!1,e.getIventoryAutoComplete("",function(e){v.inventory=e.data}),v.Receipt={name:"",photo:"",shortDescription:"",timeCookMinutes:"",servesCoun:"",difficult:"EASY",inventory:[""],ingredients:[{}],steps:[{photos:[{id:0}]}]},v.Receipt.dailyCalories=n.getDailyCalories(),v.difficult=n.getLevel(),v.units=n.getUnits(),v.steps=[{stepNumber:1,photos:[{id:0}]}],v.Receipt.ingredients[0].unit=v.units[0]}angular.module("app").controller("ReceiptsAddController",e),e.$inject=["ReceiptService","$state","Functions"]}(),function(){"use strict";function e(e,t,n,o,r,a){function i(t){return e.getIventoryAutoComplete(t)}function s(){e.receiptDelete(t.receiptID,function(e){n.go("/receipts.list")})}function c(e,t){void 0===e?(P.Receipt.photo="",P.isMainPhoto=!1):(console.log("vm.Receipt.steps[stepIndex].photos ",P.Receipt.steps[e].photos),P.Receipt.steps[e].photos.splice(t,1))}function l(t){return e.getIngrAutoComplete(t)}function u(){P.Receipt.ingredients.push({})}function p(){P.Receipt.inventory.push("")}function d(e){P.Receipt.ingredients.splice(e,1)}function m(e){P.Receipt.inventory.splice(e,1)}function g(e){console.log("step ind",e,P.steps[e]);var t=P.steps[e].photos.length||0;P.steps[e].photos.push({id:t})}function f(){var e=P.Receipt.steps.length+1;P.Receipt.steps.push({stepNumber:e,photos:[""]}),P.steps.push({photos:[{}]}),console.log("steps",P.steps)}function v(e){P.Receipt.steps.splice(e,1)}function h(e,t){void 0!==e?P.steps[e].photos.splice(t,1):P.Receipt.photo=""}function y(t,n,o){e.imgUpload(t,function(e){e.data&&(void 0!=n?P.steps[n].photos[o].img=e.data:(P.Receipt.photo=e.data,P.imgLoaded=!0))})}function A(){P.Receipt.name=o.makeTitle(P.Receipt.name,P.subname),console.log("vm.Receipt is: ",P.Receipt),P.Receipt.name?D?(a.updateAction(t.receiptID,P.Receipt),n.go(R.path,R.params)):e.receiptUpdate(t.receiptID,P.Receipt,function(e){
n.go("/receipts.list")}):P.noName=!0}function C(){n.go("/receipts.list")}var P=this;P.steps=[{photos:[]}],P.send=A,P.cancel=C,P.removePrevImg=c,P.addImg=g,P.saveImg=y,P.removeImg=h,P.addStep=f,P.removeStep=v,P.autocompleteIngr=l,P.autocompleteInvent=i,P.deleteReceipt=s,P.addTool=p,P.removeTool=m,P.addIngredient=u,P.removeIngredient=d,P.Receipt={},P.noName=!1,P.id=t.receiptID;var D=!1,R={};r.$on("$stateChangeSuccess",function(e,t,n,o,r){console.log("success",t,n,o,r),o.name.indexOf("planday.add")>=0&&(D=!0,R.path=o.name,R.params=r)}),r.$on("$locationChangeSuccess",function(e,t,n){console.log("success",e,t,n)}),P.units=o.getUnits(),P.difficult=o.getLevel(),e.getReceiptById(t.receiptID,function(e){if(P.Receipt=e.data,P.Receipt.name&&(P.Receipt.name=o.getReceiptName(P.Receipt.name),P.subname=o.getReceiptSubName(P.Receipt.name)),P.isMainPhoto=!!P.Receipt.photo,P.Receipt.dailyCalories||(P.Receipt.dailyCalories=o.getDailyCalories()),Array.isArray(P.Receipt.steps))for(var t=0;t<P.Receipt.steps.length;t++)P.steps.push({photos:[{}]})})}angular.module("app").controller("ReceiptsEditController",e),e.$inject=["ReceiptService","$stateParams","$state","Functions","$scope","PlanDayTransfer"]}(),function(){"use strict";function e(e,t,n){function o(n){for(var o=0;o<r.ReceiptsList.length;o++)r.ReceiptsList[o].id==n&&r.ReceiptsList.splice(o,1);e.receiptDelete(n,function(e){}),r.tableParams=new t({},{dataset:r.ReceiptsList})}var r=this;r.titles=[],r.ReceiptsList=[],r.deleteReceipt=o,e.getAllReceipts(function(e){var n=0;for(var o in e.data.data){r.ReceiptsList.push(e.data.data[o]),r.ReceiptsList[n].id=o;var a=r.ReceiptsList[n].name;r.ReceiptsList[n].name=a.indexOf("<h2>")>-1?a.match(/<h2>(.*?)<\/h2>/i)[1]:a,r.ReceiptsList[n].dailyCalories||(r.ReceiptsList[n].dailyCalories=[{value:0},{value:0},{value:0},{value:0}]),r.ReceiptsList[n].dailyCalories.length>0&&(r.ReceiptsList[n].cal=r.ReceiptsList[n].dailyCalories[0].value,r.ReceiptsList[n].dailyCalories.length>1&&(r.ReceiptsList[n].fat=r.ReceiptsList[n].dailyCalories[1].value),r.ReceiptsList[n].dailyCalories.length>2&&(r.ReceiptsList[n].carb=r.ReceiptsList[n].dailyCalories[2].value),r.ReceiptsList[n].dailyCalories.length>3&&(r.ReceiptsList[n].prot=r.ReceiptsList[n].dailyCalories[3].value),delete r.ReceiptsList[n].dailyCalories),n++}r.tableParams=new t({},{dataset:r.ReceiptsList}),console.log("vm.ReceiptsList",r.ReceiptsList)})}angular.module("app").controller("ReceiptsListController",e),e.$inject=["ReceiptService","NgTableParams","$state"]}(),function(){"use strict";function e(e,t,n,o){var r=this;r.Receipt={},r.header="",r.id=o.receiptID,t.getReceiptById(r.id,function(e){r.Receipt=e.data,r.header=n.trustAsHtml(r.Receipt.name)})}angular.module("app").controller("ReceiptsViewController",e),e.$inject=["$scope","ReceiptService","$sce","$stateParams"]}(),function(){"use strict";function e(e,t,n){function o(){r.dataLoading=!0,e.Create(r.user).then(function(e){console.log("response is: ",e),e.success?(n.Success("LOGIN.SUCCESS",!0),t.path("/login")):(n.Error(e.message),r.dataLoading=!1)})}var r=this;r.register=o}angular.module("app").controller("RegisterController",e),e.$inject=["UserService","$location","FlashService"]}(),function(){"use strict";function e(e,t,n,o,r){function a(){if(o.get("surveyAnswerGroup"))f.survey.answerGroups=o.get("surveyAnswerGroup"),f.purpose=o.get("purpose"),f.gender=o.get("gender"),f.activity=o.get("activity"),f.bodytype=o.get("bodytype"),f.stepsActions=o.get("stepsActions");else{f.survey.answerGroups=[];for(var e=["цель","желаемый вес","пол","дата рождения","рост","вес","активность","телосложение","имя","еиайл","пароль","телефон"].map(function(e){return encodeURIComponent(e)}),t=0;t<e.length;t++)f.survey.answerGroups[t]={name:e[t],answerText:[""]};f.survey.answerGroups[3].answerText[0]="1993-07-03",f.purpose=[{name:"PURPOSE.1",selected:!1},{name:"PURPOSE.2",selected:!1},{name:"PURPOSE.3",selected:!1}],f.gender=[{name:"GENDER.MALE",selected:!1},{name:"GENDER.FEMALE",selected:!1}],f.activity=[{name:"SURVEY-HEADERS.INTENS4",selected:!1},{name:"SURVEY-HEADERS.INTENS1",selected:!1},{name:"SURVEY-HEADERS.INTENS2",selected:!1},{name:"SURVEY-HEADERS.INTENS3",selected:!1}],f.bodytype=[{name:"BODYTYPE.1",selected:!1},{name:"BODYTYPE.2",selected:!1},{name:"BODYTYPE.3",selected:!1}],f.stepsActions[0]="active"}}function i(){o.set("step",f.step),o.set("purpose",f.purpose),o.set("activity",f.activity),o.set("gender",f.gender),o.set("bodytype",f.bodytype),o.set("stepsActions",f.stepsActions),o.set("surveyAnswerGroup",f.survey.answerGroups)}function s(e){for(var t=0;t<3;t++)f.purpose[t].selected=!1;f.purpose[e].selected=!0,f.survey.answerGroups[0].answerText[0]=f.purpose[e].name}function c(e){for(var t=0;t<2;t++)f.gender[t].selected=!1;f.gender[e].selected=!0,f.survey.answerGroups[2].answerText[0]=f.gender[e].name}function l(e){for(var t=0;t<3;t++)f.bodytype[t].selected=!1;f.survey.answerGroups[7].answerText[0]=f.bodytype[e].name,f.bodytype[e].selected=!0}function u(e){for(var t=0;t<4;t++)f.activity[t].selected=!1;f.activity[e].selected=!0,f.survey.answerGroups[6].answerText[0]=f.activity[e].name}function p(){f.survey.opinionId="firstOpinion",f.survey.opinionName="",f.survey.timestamp=Date.parse(new Date),e.createUpdateFirstOpinion(f.survey,function(e){f.step=6})}function d(){switch(i(),f.step){case 0:if(!f.purpose[0].selected&&!f.purpose[1].selected&&!f.purpose[2].selected||!f.survey.answerGroups[1].answerText[0])return void(f.check1=!0);break;case 1:if(!f.survey.answerGroups[2].answerText[0]||!f.survey.answerGroups[3].answerText[0]||!f.survey.answerGroups[4].answerText[0])return void(f.check2=!0);break;case 2:if(!f.survey.answerGroups[6].answerText[0])return void(f.check3=!0);break;case 3:if(!f.survey.answerGroups[7].answerText[0])return void(f.check4=!0);break;case 4:var e=f.survey.answerGroups[9].answerText[0],t=e.match(/.+@.+\..+/i);if(console.log(t),!t)return f.wrongEmail=!0,void(f.check5=!0);if(f.survey.answerGroups[10].answerText[0]!=f.pass)return f.wrongPass=!0,void(f.check5=!0);if(!(f.survey.answerGroups[8].answerText[0]&&f.survey.answerGroups[9].answerText[0]&&f.survey.answerGroups[10].answerText[0]&&f.survey.answerGroups[11].answerText[0]))return void(f.check5=!0);v.fullname=f.survey.answerGroups[8].answerText[0],v.phone=f.survey.answerGroups[11].answerText[0],v.email=f.survey.answerGroups[9].answerText[0],v.password=f.survey.answerGroups[10].answerText[0],n.Create(v).then(function(e){return o.clearAll(),e.success?void(f.survey.userId=e.data.data.userId):void(f.check5=!0)})}m()}function m(){f.wrongPass=!1,f.check1=!1,f.check2=!1,f.check3=!1,f.check4=!1,f.check5=!1,f.step<6?f.step++:f.step,console.log(f.step);for(var e=0;e<f.stepsActions.length;e++)f.stepsActions[e]="done";f.stepsActions[f.step]="active",f.stepBar="step"+(f.step+1)}function g(){f.stepsActions[f.step]="",f.step--,f.stepsActions[f.step]="active",f.stepBar="step"+(f.step+1)}var f=this,v={};f.send=p,f.changeGender=c,f.changeBodyType=l,f.changeActivity=u,f.changePurpose=s,f.stepBar="step1",f.step=o.get("step")||0,f.stepsActions=[],f.next=d,f.back=g,f.survey={},f.check1=!1,f.check2=!1,f.check3=!1,f.wrongEmail=!1,f.check4=!1,f.check5=!1,f.wrongPass=!1,window.onbeforeunload=function(){i()},f.stepsNames=["SURVEY-HEADERS.STEP1","SURVEY-HEADERS.STEP2","SURVEY-HEADERS.STEP3","SURVEY-HEADERS.STEP4","SURVEY-HEADERS.STEP5","SURVEY-HEADERS.STEP6"],a()}angular.module("app").controller("SurveyController",e),e.$inject=["OpinionService","$state","UserService","localStorageService","$scope"]}(),function(){"use strict";function e(e,t,n){function o(e){n.go("/members.view",{userId:e})}function r(e){}var a=this,i="?size=100&from=0";a.users=[],a.viewMember=o,a.deleteMember=r,e.GetAll(i).then(function(e){console.log(e);var n=0;for(var o in e.data.data.data)a.users.push(e.data.data.data[o]),a.users[n].id=o,n++;a.tableParams=new t({},{dataset:a.users})})}angular.module("app").controller("MembersListController",e),e.$inject=["UserService","NgTableParams","$state"]}(),function(){"use strict";function e(e,t,n,o){function r(){i.program=[],o.getProgram(n.params.userId,function(e){for(var n in e.data)e.data[n].dayId=n,i.program.push(e.data[n]);i.tableParams=new t({},{dataset:i.program})})}function a(e){o.deleteProgram(e,function(e){r()})}var i=this;i.user={},i.deleteDay=a,e.GetById(n.params.userId).then(function(e){i.user=e.data.data}),console.log(n.params.userId),r()}angular.module("app").controller("viewMembersController",e),e.$inject=["UserService","NgTableParams","$state","ProgramsService"]}(),function(){"use strict";function e(e,t,n,o,r,a){function i(){f.dayPlan=a.getLastDay()}function s(){f.dayPlan=a.getTodayPlan()}function c(){f.dayPlan=a.getFirstDay()}function l(){if("plan"in f.dayPlan)return f.dayPlan.plan.planDate==a.getLastDate()}function u(){if("plan"in f.dayPlan)return console.log("Is First vm.dayPlan.plan.planDate",f.dayPlan.plan.planDate),f.dayPlan.plan.planDate==a.getFirstDate()}function p(){if("plan"in f.dayPlan)return f.dayPlan.plan.planDate==a.getToday()}function d(t){a.setFullPageData(t),a.setCurrentDay(f.dayPlan.dayNumber),"cardType"in t?e.go("card"):e.go("receipt")}function m(){f.dayPlan=a.getDay(f.dayPlan.dayNumber+1)}function g(){f.dayPlan=a.getDay(f.dayPlan.dayNumber-1)}var f=this;f.back=g,f.forward=m,f.showPage=d,f.isToday=p,f.isFirstDate=u,f.isLastDate=l,f.dayPlan={},f.getFirstDay=c,f.getToday=s,f.getLastDay=i,void 0!=a.getCurrentDay()&&(f.dayPlan=a.getDay(a.getCurrentDay())),n.$watch("isPlanArrLoaded",function(){n.isPlanArrLoaded&&void 0===a.getCurrentDay()&&(f.dayPlan=a.getTodayPlan(),f.dayPlan||(f.dayPlan=a.getFirstDay()))}),t.$on("$locationChangeSuccess",function(){t.actualLocation=o.path()})}angular.module("app").controller("ClientOfficeController",e),e.$inject=["$state","$rootScope","$scope","$location","Functions","PlanDaysData"]}(),function(){"use strict";function e(e,t,n,o){t.header=!0,t.page.id="prep-page",console.log("PrepCtrl")}angular.module("app").controller("ClientPrepController",e),e.$inject=["$state","$rootScope","ReceiptService","$sce"]}(),function(){"use strict";function e(e,t,n,o,r){var a=this;a.Action=r.getFullPageData(),console.log("vm.Action",a.Action)}angular.module("app").controller("ClientCardController",e),e.$inject=["$scope","$state","localStorageService","$rootScope","PlanDaysData"]}(),function(){"use strict";function e(e,t,n,o){function r(){s.receipt.ingredients.forEach(function(e,t){e.value=c[t]*s.receipt.servesCount})}function a(){s.receipt.servesCount++,r()}function i(){s.receipt.servesCount>1&&s.receipt.servesCount--,r()}var s=this;s.stepPhotos=[],s.increaseServ=a,s.decreaseServ=i,s.receipt=o.getFullPageData(),console.log("vm.receipt",s.receipt),"servesCount"in s.receipt?s.receipt.servesCount||(s.receipt.servesCount=1):s.receipt.servesCount=1,s.inventory=s.receipt.inventory.join(" / "),s.stepsAmount=s.receipt.steps.length;var c=[];s.header=n.trustAsHtml(s.receipt.name),s.receipt.ingredients.forEach(function(e){c.push(e.value/s.receipt.servesCount)}),s.receipt.steps.forEach(function(e){s.stepPhotos.push(e.photos.length)}),s.userId=t.params.userId}angular.module("app").controller("ClientReceiptController",e),e.$inject=["$scope","$state","$sce","PlanDaysData"]}(),function(){"use strict";function e(e,t,n){function o(){}var r=this;r.userId=t.params.userId,r.back=o,e.datePicker={},e.datePicker.date={startDate:null,endDate:null},e.$watch("isPlanArrLoaded",function(){e.isPlanArrLoaded&&(r.range=n.getAvailableDates())}),e.$watch("datePicker.date",function(){e.datePicker.date.endDate&&e.datePicker.date.startDate&&(r.list=n.getIngredients(moment(e.datePicker.date.startDate).format("YYYYMMDD"),moment(e.datePicker.date.endDate).format("YYYYMMDD")))})}angular.module("app").controller("ClientShoppingController",e),e.$inject=["$scope","$state","PlanDaysData"]}();